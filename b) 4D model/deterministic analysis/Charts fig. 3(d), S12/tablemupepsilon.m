%% Code ot obtain the charts depicting the (epsilon, muprime) combinations that result in a monostable or bistable system, for different values of mu

% For each parameter regime the different regiones in which the system is
% monostable or bistable have been obtained in the following way:

% 1) we find the equilibrium points by using the mathematica code "table
% 2) we evaluate if the equilibrium point was stable or unstable by using
% the matlab code "eigBIFPLOT4DSYSTEM"

%% mu=1

A=[0.8,0.1;...
    2,0.2;...
    5,0.3;...
    20,0.4;...
    100,0.465];




B=[0.01,15;...
    0.015,11;...
    0.02,9;...
    0.025, 8;...
    0.03,7;...
    0.035,6.5;...
    0.04,6;...
    0.045,5.5;...
    0.055,5;...
    0.065,4.5;...
    0.085,4;...    
    0.1,3.5;...
    0.15,3;...
    0.2,2.5;...
    0.35,2;...
    0.7,1.5;...
    2,1;...
    2.5,0.9;...
    3,0.85;...
    4,0.8;...
    5,0.75;...
    6.5,0.7;...
    9,0.65;...
    20,0.55;...
    45,0.5;...
    100,0.485];



AA=[0.8,0.1;...
    2,0.2;...
    5,0.3;...
    20,0.4;...
    100,0.465;...
    100,0.1;...
    0.8,0.1];




BB=[0.01,15;...
    0.015,11;...
    0.02,9;...
    0.025, 8;...
    0.03,7;...
    0.035,6.5;...
    0.04,6;...
    0.045,5.5;...
    0.055,5;...
    0.065,4.5;...
    0.085,4;... 
    0.1,3.5;...
    0.15,3;...
    0.2,2.5;...
    0.35,2;...
    0.7,1.5;...
    2,1;...
    2.5,0.9;...
    3,0.85;...
    4,0.8;...
    5,0.75;...
    6.5,0.7;...
    9,0.65;...
    20,0.55;...
    45,0.5;...
    100,0.485;...
    100,0.465;...
    20,0.4;...
    5,0.3;...  
    2,0.2;...
    0.8,0.1;... 
    0.01,0.1;...
    0.01,15];


figure(1)
loglog(A(:,1),A(:,2),'LineWidth',1,'Color', [0 0 0]);
hold on
loglog(B(:,1),B(:,2),'LineWidth',1, 'Color', [0 0 0]);
hold on
fill(BB(:,1),BB(:,2), 'r');
hold on
fill(AA(:,1),AA(:,2),[1 0.7 0]);
xlabel('mu')
axis([0.01 10 0.1 100]);
% grid on
% grid minor


%% mu=0.1

B=[...
    0.01,35;...
    0.015,30;...
    0.025,25;...
    0.04,20;...
    0.085,15;...
    0.3,10;...
    0.4,9.5;...
    0.5,9;...
    0.65,8.5;...
    1,8;...
    2,7.5;...
    4,7;...
    100,6.704];

BB=[...
    0.01,35;...
    0.015,30;...
    0.025,25;...
    0.04,20;...
    0.085,15;...
    0.3,10;...
    0.4,9.5;...
    0.5,9;...
    0.65,8.5;...
    1,8;...
    2,7.5;...
    4,7;...
    100,6.704;...
    100,0.1;...
    0.01,0.1;...
    0.01,35];


figure(2)
loglog(B(:,1),B(:,2),'LineWidth',1, 'Color', [0 0 0]);
hold on
fill(BB(:,1),BB(:,2), 'r');
xlabel('mu')
axis([0.01 10 0.1 100]);
% grid on
% grid minor

%% mu=10

A=[...
    0.25,0.1;...
    0.3,0.15;...
    0.35,0.2;...
    0.4,0.25;...
    0.45,0.3;...
    0.5,0.35;...
    0.65,0.3;...
    0.8,0.25;...
    1,0.2;...
    1.5,0.15;...
    3.5,0.1]

B=[0.01,7;...
   0.015,6.5;...
   0.02,5.75;...
   0.025,4.75;...
   0.03,4;...
   0.035,3.5;...
   0.045,3;...
   0.055,2.5;... 
   0.07,2;... 
   0.1,1.5;...
   0.15,1;...
   0.2,0.8;...
   0.25,0.7;...
   0.3,0.6;...
   0.35,0.5;...
   0.45,0.4;...
   0.5,0.35;...
   0.55,0.4;...
   0.65,0.45;...
   0.85,0.5;...
   1.5,0.55;...
   2.5,0.6;...
   15,0.65;...
   100,0.67213]
    


AA=[0.25,0.1;...
    0.3,0.15;...
    0.35,0.2;...
    0.4,0.25;...
    0.45,0.3;...
    0.5,0.35;...
    0.65,0.3;...
    0.8,0.25;...
    1,0.2;...
    1.5,0.15;...
    3.5,0.1;...
    0.25,0.1]

BB=[0.01,7;...
   0.015,6.5;...
   0.02,5.75;...
   0.025,4.75;...
   0.03,4;...
   0.035,3.5;...
   0.045,3;...
   0.055,2.5;... 
   0.07,2;... 
   0.1,1.5;...
   0.15,1;...
   0.2,0.8;...
   0.25,0.7;...
   0.3,0.6;...
   0.35,0.5;...
   0.45,0.4;...
   0.5,0.35;...  
    0.45,0.3;...
    0.4,0.25;...
    0.35,0.2;...
    0.3,0.15;...
    0.25,0.1;...
    0.01,0.1;...
    0.01,7]
       







CC=[0.5,0.35;...
   0.55,0.4;...
   0.65,0.45;...
   0.85,0.5;...
   1.5,0.55;...
   2.5,0.6;...
   15,0.65;...
   100,0.67213;...
   100,0.1;...
   3.5,0.1;...
   1.5,0.15;...
   1,0.2;...
   0.8,0.25;...
   0.65,0.3;...
   0.5,0.35]


figure(3)
loglog(A(:,1),A(:,2),'LineWidth',1,'Color', [0 0 0]);
hold on
loglog(B(:,1),B(:,2),'LineWidth',1, 'Color', [0 0 0]);
hold on
fill(BB(:,1),BB(:,2), 'r');
hold on
fill(AA(:,1),AA(:,2),[1 0.7 0]);
hold on
fill(CC(:,1),CC(:,2), [0 0.8 0]);
xlabel('mu')
axis([0.01 10 0.1 100]);
% grid on 
% grid minor
